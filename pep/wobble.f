      subroutine WOBBLE(jd, fract, x, y)
 
      implicit none
 
 
c*** start of declarations inserted by spag
      real      f1, f2, s, s2, t, t2, x, xf, y, yf
      integer   i, int, j, jd, nr
 
c*** end of declarations inserted by spag
 
 
c
c f.amuchastegui     may 1969     subroutine wobble
c
c
c        determine wobble from 1956 to the present.  the source is
c        controlled by jct(33):
c           jct(33)=-1  use bih values tabulated in this routine at
c                       10-day intervals to match usno a1-ut1
c                  = 0  (default) after 3 jan 1969 use bih values in
c                       subroutine bihut1 tabulated at 5-day intervals
c                       to match bih a1-ut1; before 3 jan 1969, same as
c                       for jct(33)= -1
c                  = 1  use revised values determined from pep solutions
c                       tabulated at 5-day interval in subroutine pepwob
c
c$$$$$period of validity to be extended when routine revised
c        call xwobbl to go beyond table
c
c        common
      include 'fcntrl.inc'
      real*4    result(2), y1(2), y2(2)
      real*10 fract, tt
      integer*2 cc(840, 2)
      integer*2 xc(840), yc(840)
      equivalence (cc(1,1), xc), (cc(1,2), yc)
c
c      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
c
c        wobble at ten days interval from b.i.h.
c        (bureau international de l'heure)
c
c        tabular points from  2435480 to  2437150 (julian day numbers)
c        (january 7,1956 to august 3,1960, 0 hr)
      integer*2 x5660(168)/35, 88, 126, 155, 177, 200, 224, 240, 238,
     .          232, 223, 218, 216, 214, 212, 210, 207, 204, 200, 195,
     .          185, 167, 146, 123, 99, 77, 62, 49, 13, -27, -57, -87,
     .          -122, -162, -187, -206, -218, -225, -225, -221, -209,
     .          -206, -147, -100, -54, -6, 26, 57, 105, 153, 193, 232,
     .          270, 326, 356, 378, 386, 391, 394, 396, 388, 368, 336,
     .          291, 243, 194, 146, 98, 41, -22, -92, -145, -181, -210,
     .          -221, -227, -232, -232, -223, -211, -191, -165, -133,
     .          -101, -68, -32, 6, 46, 86, 123, 156, 187, 218, 248, 276,
     .          304, 332, 356, 376, 393, 403, 388, 357, 321, 278, 231,
     .          182, 130, 76, 22, -30, -72, -104, -126, -143, -158,
     .          -169, -175, -174, -168, -160, -150, -137, -121, -102,
     .          -81, -57, -30, 1, 37, 78, 122, 174, 226, 270, 302, 319,
     .          323, 323, 317, 308, 294, 275, 252, 223, 191, 160, 131,
     .          102, 73, 45, 17, -11, -36, -57, -74, -87, -96, -101,
     .          -101, -100, -99, -96, -90, -80, -66, -48, -28/
      integer*2 y5660(168)/331, 325, 320, 315, 310, 310, 310, 310, 293,
     .          274, 250, 220, 184, 144, 104, 68, 43, 25, 13, 1, -3, 1,
     .          6, 14, 24, 25, 26, 27, 35, 43, 56, 73, 93, 116, 141,
     .          169, 195, 224, 257, 287, 315, 339, 377, 404, 420, 440,
     .          453, 460, 460, 454, 440, 418, 393, 358, 313, 274, 241,
     .          207, 173, 138, 110, 82, 54, 26, -2, -27, -47, -59, -69,
     .          -75, -77, -72, -59, -42, -8, 33, 79, 133, 200, 243, 289,
     .          334, 376, 406, 426, 443, 458, 468, 473, 470, 462, 449,
     .          427, 395, 361, 328, 295, 256, 215, 173, 131, 89, 47, 7,
     .          -27, -53, -69, -76, -81, -79, -70, -59, -46, -28, -5,
     .          22, 53, 87, 123, 161, 197, 232, 265, 296, 324, 349, 369,
     .          382, 384, 381, 375, 365, 347, 322, 293, 269, 249, 231,
     .          213, 195, 177, 157, 135, 113, 95, 83, 69, 55, 43, 33,
     .          28, 28, 34, 45, 61, 81, 100, 118, 135, 151, 166, 180,
     .          193, 205, 217, 229, 243, 258/
c
c tabular points from  2437160 to 2438830 (julian day numbers)
c (august 13,1960 to march 10,1965, 0 hr)
      integer*2 x6065(168)/ - 6, 14, 34, 52, 70, 88, 104, 119, 133, 146,
     .          148, 148, 147, 145, 142, 142, 142, 141, 140, 138, 135,
     .          131, 127, 123, 118, 111, 101, 88, 75, 64, 55, 46, 37,
     .          28, 19, 11, 3, -3, -8, -12, -15, -18, -21, -24, -27,
     .          -29, -31, -33, -31, -26, -20, -38, -43, -46, -44, -42,
     .          -36, -18, 8, 30, 46, 56, 65, 72, 76, 77, 78, 80, 87, 93,
     .          97, 97, 89, 77, 63, 49, 34, 16, -3, -24, -48, -70, -93,
     .          -115, -136, -156, -175, -190, -194, -193, -184, -172,
     .          -157, -138, -117, -92, -62, -32, -4, 26, 60, 94, 127,
     .          156, 180, 199, 212, 220, 222, 214, 195, 177, 156, 134,
     .          108, 75, 33, -8, -45, -78, -108, -138, -168, -202, -228,
     .          -247, -262, -272, -273, -265, -248, -228, -202, -171,
     .          -137, -105, -75, -46, -18, 12, 49, 89, 129, 163, 189,
     .          209, 224, 235, 240, 236, 228, 217, 202, 183, 157, 123,
     .          85, 48, 18, -10, -39, -70, -105, -146, -176, -197, -209,
     .          -217/
      integer*2 y6065(168)/272, 284, 294, 302, 305, 305, 303, 299, 293,
     .          283, 269, 252, 235, 226, 220, 210, 199, 188, 177, 164,
     .          149, 134, 121, 110, 101, 99, 99, 100, 104, 110, 118,
     .          128, 140, 154, 170, 187, 203, 207, 210, 213, 215, 217,
     .          219, 220, 221, 222, 222, 223, 225, 232, 245, 237, 253,
     .          264, 268, 277, 287, 296, 303, 303, 298, 289, 281, 275,
     .          269, 260, 247, 233, 218, 202, 185, 167, 151, 137, 124,
     .          114, 108, 103, 102, 105, 112, 122, 134, 153, 179, 214,
     .          242, 267, 288, 308, 331, 356, 374, 385, 395, 407, 419,
     .          429, 432, 425, 413, 404, 390, 368, 339, 306, 273, 236,
     .          200, 164, 134, 108, 87, 64, 42, 25, 14, 15, 22, 32, 45,
     .          59, 78, 106, 134, 162, 190, 220, 253, 289, 325, 359,
     .          390, 417, 443, 465, 479, 482, 478, 472, 467, 460, 446,
     .          424, 394, 360, 330, 301, 270, 235, 199, 165, 136, 111,
     .          92, 74, 58, 49, 52, 54, 55, 57, 62, 75, 94, 120, 150,
     .          180/
c
c tabular points from  2438840  to  2440510 (julian day numbers)
c (march 20,1965 to october 15, 1969, 0 hr)
      integer*2 x6569(168)/ - 225, -228, -227, -219, -204, -186, -165,
     .          -142, -117, -88, -52, -14, 24, 62, 99, 132, 158, 176,
     .          185, 192, 197, 200, 199, 195, 186, 167, 147, 126, 102,
     .          76, 49, 20, -12, -43, -70, -92, -107, -122, -138, -154,
     .          -169, -175, -173, -165, -153, -141, -126, -108, -89,
     .          -69, -48, -27, -7, 13, 32, 49, 65, 81, 98, 113, 124,
     .          127, 125, 121, 112, 97, 81, 67, 56, 46, 34, 22, 10, 0,
     .          -10, -20, -27, -27, -21, -22, -22, -23, -23, -21, -19,
     .          -17, -13, -9, -1, 8, 4, -3, -7, -9, -11, -15, -21, -22,
     .          -16, -15, -14, -9, -4, -6, -6, -6, -4, 0, 4, 7, 9, 11,
     .          14, 18, 22, 28, 37, 47, 55, 62, 68, 74, 79, 82, 80, 71,
     .          59, 46, 37, 31, 24, 8, -14, -37, -68, -101, -134, -146,
     .          -149, -149, -137, -119, -98, -78, -62, -45, -34, -25,
     .          -14, -1, 14, 29, 46, 62, 80, 99, 117, 134, 147, 152,
     .          151, 137, 120, 98, 79, 65, 50, 39/
      integer*2 y6569(168)/211, 245, 281, 315, 349, 383, 410, 425, 441,
     .          454, 465, 468, 460, 448, 425, 401, 377, 350, 323, 299,
     .          275, 249, 222, 192, 163, 137, 117, 101, 87, 73, 61, 54,
     .          52, 54, 63, 74, 87, 104, 124, 149, 177, 202, 223, 243,
     .          263, 285, 304, 322, 340, 356, 361, 361, 361, 358, 354,
     .          350, 346, 341, 332, 316, 294, 273, 254, 235, 220, 206,
     .          190, 175, 169, 167, 165, 164, 164, 166, 169, 173, 177,
     .          183, 193, 200, 202, 204, 206, 210, 216, 220, 222, 216,
     .          210, 210, 207, 203, 204, 207, 209, 212, 219, 232, 246,
     .          253, 256, 265, 270, 272, 274, 276, 273, 269, 263, 261,
     .          258, 254, 254, 256, 258, 250, 236, 220, 208, 198, 188,
     .          180, 174, 168, 165, 162, 160, 158, 151, 145, 141, 133,
     .          130, 130, 139, 156, 186, 215, 238, 261, 282, 297, 307,
     .          316, 328, 337, 350, 360, 368, 372, 373, 371, 365, 357,
     .          346, 332, 317, 300, 273, 241, 205, 173, 147, 125, 115,
     .          111, 108, 106/
c
c tabular points from  2440520  to  2442190 (julian day numbers)
c (october 25, 1969 to  may 22, 1974, 0 hr)
      integer*2 x6974(168)/29, 21, 4, -20, -44, -74, -103, -129, -151,
     .          -166, -174, -173, -161, -139, -119, -109, -106, -101,
     .          -89, -71, -51, -21, 17, 55, 88, 119, 145, 168, 186, 199,
     .          207, 209, 205, 199, 191, 183, 160, 120, 78, 48, 24, 0,
     .          -29, -57, -85, -111, -133, -152, -174, -196, -209, -216,
     .          -212, -200, -192, -183, -170, -150, -129, -104, -61, 2,
     .          60, 103, 140, 170, 198, 224, 245, 258, 263, 264, 252,
     .          229, 203, 179, 157, 135, 109, 83, 55, 22, -14, -52, -83,
     .          -107, -127, -151, -174, -191, -194, -191, -184, -173,
     .          -160, -145, -120, -89, -54, -20, 16, 52, 88, 113, 131,
     .          147, 152, 157, 161, 168, 174, 177, 180, 177, 169, 162,
     .          151, 134, 114, 92, 71, 53, 34, 14, -10, -34, -58, -83,
     .          -100, -111, -116, -117, -117, -114, -105, -89, -70, -51,
     .          -33, -17, -3, 8, 25, 41, 55, 71, 85, 99, 107, 112, 118,
     .          126, 131, 131, 123, 110, 98, 88, 80, 71, 58, 42, 26, 10,
     .          -2, -11, -20, -25/
      integer*2 y6974(168)/104, 102, 101, 106, 114, 125, 135, 146, 175,
     .          210, 251, 290, 323, 350, 371, 388, 399, 410, 421, 434,
     .          444, 448, 448, 442, 426, 402, 373, 342, 309, 276, 244,
     .          213, 183, 155, 128, 101, 78, 63, 53, 38, 23, 13, 13, 22,
     .          35, 57, 85, 117, 148, 178, 211, 253, 301, 340, 370, 397,
     .          424, 452, 480, 505, 519, 524, 520, 500, 476, 450, 421,
     .          387, 351, 317, 283, 249, 211, 175, 139, 118, 103, 92,
     .          78, 62, 48, 35, 26, 27, 34, 50, 74, 105, 140, 178, 214,
     .          249, 281, 310, 335, 356, 376, 394, 409, 424, 433, 436,
     .          435, 429, 418, 401, 375, 349, 325, 304, 283, 262, 245,
     .          227, 209, 178, 150, 123, 108, 92, 79, 90, 100, 108, 115,
     .          124, 137, 156, 176, 194, 213, 227, 241, 259, 277, 295,
     .          308, 319, 330, 337, 339, 340, 342, 346, 348, 346, 341,
     .          333, 322, 310, 299, 285, 269, 250, 228, 208, 194, 188,
     .          184, 180, 179, 181, 186, 192, 198, 202, 205, 208/
c
c tabular points from  2442200  to  2442540 (julian day numbers)
c (june 1, 1974 to     may  7, 1975, 0 hr)
      integer*2 x7475(35)/ - 28, -25, -19, -9, 2, 11, 17, 17, 21, 19,
     .          18, 20, 18, 14, 5, -5, -14, -20, -27, -33, -36, -38,
     .          -40, -37, -30, -20, -12, -6, -2, 3, 12, 2, 35, 63, 65/
      integer*2 y7475(35)/211, 213, 215, 216, 216, 217, 219, 221, 218,
     .          218, 218, 219, 224, 232, 244, 254, 261, 265, 269, 273,
     .          277, 280, 283, 288, 294, 302, 314, 325, 333, 339, 344,
     .          336, 336, 336, 315/
 
      equivalence (xc, x5660), (xc(169), x6065),
     .            (xc(337), x6569), (xc(505), x6974)
      equivalence (yc, y5660), (yc(169), y6065),
     .            (yc(337), y6569), (yc(505), y6974)
      equivalence (xc(673), x7475), (yc(673), y7475)
c$$$$$ extend table when routine revised from usno time cards
c
c$$$  julian day number of given calendar date =
c$$$                   = julian date at midnight beginning of day + 0.5
c$$$                   = mjd + 2400001 (mjd=usno modified julian date)
c
c      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
c
      if(Jct(33).ge.0) then
         if(jd.ge.2440225) then
            if(Jct(33).gt.0) then
               call WOBRED(jd, fract, x, y)
            else
               call BIHWOB(jd, fract, x, y)
            endif
            go to 100
         endif
      endif
c
c take wobble from international polar motion service
c (formerly called international latitude service)
c before january 17.0, 1956
      if(jd.lt.2435490) then
         call WOBILS(jd, fract, x, y)
c
c wobble is taken from subroutine xwobbl  (extrapolation)
      else if(jd.lt.2442530) then
c
c set up indices for 10 days b.i.h. interpolation
         tt  = jd - 2435480
         tt  = (tt + fract)/10._10
         int = tt
         t   = tt - int
c
c second difference interpolation
         t2 = t*t
         s  = 1._10 - t
         s2 = s*s
         do j = 1, 2
            do i = 1, 2
               nr    = int + i
               f1    = cc(nr, j)
               f2    = 0.1666667E0*(cc(nr+1,j) + cc(nr-1,j))
               y1(i) = 1.3333333E0*f1 - f2
               y2(i) = -0.3333333E0*f1 + f2
               end do
            result(j) = t*(y1(2) + t2*y2(2)) + s*(y1(1) + s2*y2(1))
            end do
 
         x = result(1)*1.0E-03
         y = result(2)*1.0E-03
      else
c$$$$$ date to be extended when routine revised
c
         call XWOBBL(jd, fract, x, y)
      endif
c
c add analytic model terms to wobble
  100 call WOBBLF(jd, fract, xf, yf)
      x = x + xf
      y = y + yf
 
      return
      end
