      subroutine PRCES(tt)
 
      implicit none
 
c
c m.e.ash   aug 1967   subroutine prces
c determination of precession matrix and sine and cosine of
c mean obliquity from series expansions
c
      real*10 tt, tx(5), DOTN
      integer*4 i, iepch, j, ntrmo, ntrmp
c commons
      include 'fcntrl.inc'
      include 'precmn.inc'
c PREC(j,k)=precession matrix j,k=1,2,3
c SMOBLQ,CMOBLQ= sine and cosine of mean obliquity
c tt = input Julian ephemeris date
c
c Polynomial coefficients for obliquity.  Two sets: 1950 and 2000.
      real*10 smcf(5,2)/
     . 0.3978811865927521_10, -0.5705138931924035E-8_10,
     . -0.1831208750616861E-16_10, 0.1652267540061146E-21_10,
     . 0.4457839513281269E-30_10,
     . 3.977771559319137E-1_10, -5.701212805547000E-9_10,
     . -9.646966729155364E-18_10, 1.655319933694906E-22_10,
     . 4.459351173430528E-31_10/
      real*10 cmcf(5,2)/
     . 0.9174369522509674_10, 0.2474248985002171E-8_10,
     . -0.1313357174099198E-16_10,-0.7173527734647543E-22_10,
     . 0.1027328976209653E-29_10,
     . 9.174820620691818E-1_10, 2.471778260207653E-9_10,
     . -1.686072705018669E-17_10,-7.178142406556107E-23_10,
     . 1.028455428263141E-30_10/
      real*10 prcf(5,3,3,2), prcf19(5,3,3), prcf20(5,3,3)
      equivalence (prcf(1,1,1,1),prcf19(1,1,1)),
     .            (prcf(1,1,1,2),prcf20(1,1,1))
      data prcf19/
     . 0._10,                -2.226033980525170E-13_10,
     . -2.690338532536629E-21_10, 8.191221606878398E-27_10,
     1 1.799482228496884E-34_10,
     . 6.119064710033514E-7_10,5.069757392906882E-15_10,
     . -4.532171621907884E-20_10,-9.636891635855726E-28_10,
     2 1.026042988973274E-33_10,
     . 2.660399722772102E-7_10,-1.548183978048984E-15_10,
     . -1.972920159180986E-20_10, 3.791379581151438E-29_10,
     3 4.504040850770918E-34_10,
     . -6.119064710033514E-7_10,-5.069757392906882E-15_10,
     . 4.532171621907884E-20_10, 8.619581795926373E-28_10,
     1 -1.029436583273318E-33_10,
     . 0._10,                 -1.872147646278876E-13_10,
     . -3.102217355136802E-21_10, 6.882478825535445E-27_10,
     2 1.912152074467512E-34_10,
     . 0._10,                 -8.139579029098856E-14_10,
     . 1.816826849700918E-22_10, 3.024323052660049E-27_10,
     3 2.585500549810001E-37_10,
     . -2.660399722772102E-7_10,1.548183978048984E-15_10,
     . 1.972920159180986E-20_10, 1.960730253190783E-28_10,
     1 -4.392983540750854E-34_10,
     . 0._10,                 -8.139579029098856E-14_10,
     . -5.830970067593366E-22_10, 2.994360606801518E-27_10,
     2 5.717394590429111E-35_10,
     . 0._10,                 -3.538863342462938E-14_10,
     . 4.118788226001726E-22_10, 1.308742781342952E-27_10,
     3 -1.126698459706283E-35_10/
      data prcf20/
     . 0._10,                -2.228022338276328E-13_10,
     . -2.694706380414427E-21_10, 8.266949755380744E-27_10,
     1 1.808377577688814E-34_10,
     . 6.122305744024312E-7_10,5.075209994113592E-15_10,
     . -4.547798474709948E-20_10,-9.656740934186861E-28_10,
     2 1.050675780132688E-33_10,
     . 2.660417099293544E-7_10,-1.550479996554794E-15_10,
     . -1.976545558979824E-20_10, 3.817155307348521E-29_10,
     3 4.519990037702968E-34_10,
     . -6.122305744024312E-7_10,-5.075209994113592E-15_10,
     . 4.547798474709948E-20_10, 8.637146339437863E-28_10,
     1 -1.050209166859392E-33_10,
     . 0._10,                 -1.874131381165654E-13_10,
     . -3.107198729909124E-21_10, 6.952100935630818E-27_10,
     2 1.921570798666866E-34_10,
     . 0._10,                 -8.143943444252682E-14_10,
     . 1.827630009077635E-22_10, 3.031998708059510E-27_10,
     3 2.511284066259539E-37_10,
     . -2.660417099293544E-7_10,1.550479996554794E-15_10,
     . 1.976545558979824E-20_10, 1.964634538081621E-28_10,
     1 -4.497603035296188E-34_10,
     . 0._10,                 -8.143943444252682E-14_10,
     . -5.837292871020710E-22_10, 3.031039443388008E-27_10,
     2 5.722897120199517E-35_10,
     . 0._10,                  -3.538909571106738E-14_10,
     . 4.124923494946971E-22_10, 1.314848819749926E-27_10,
     3-1.131932209780525E-35_10/
c
      iepch = 1
      Tpr = tt - 2433282.423_10
      if(Jct(13).eq.1) then
         iepch = 2
         Tpr = tt - 2451545._10
      endif
      tx(1)=Tpr
      tx(2)=tx(1)*Tpr
      tx(3)=tx(2)*Tpr
      tx(4)=tx(3)*Tpr
      ntrmo=3
      ntrmp=3
      if(ABS(Tpr).gt.1.E4_10) ntrmp=4
      if(ABS(Tpr).gt.5.E4_10) then
         ntrmp=5
         ntrmo=4
         tx(5)=tx(4)*Tpr
      endif
c
c sine and cosine of obliquity
      Smoblq = smcf(1,iepch) + DOTN(smcf(2,iepch),tx,ntrmo)
      Cmoblq = cmcf(1,iepch) + DOTN(cmcf(2,iepch),tx,ntrmo)
c
c precession matrix
      do i=1,3
         do j=1,3
            Prec(i,j) = DOTN(prcf(1,i,j,iepch),tx,ntrmp)
            if(i.eq.j) Prec(i,j) = Prec(i,j)+1._10
            end do
         end do
 
      return
      end
